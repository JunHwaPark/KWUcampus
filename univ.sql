CREATE database UNIVERSITY;
use UNIVERSITY;

CREATE TABLE if not exists UNIVERSITY.PROFESSOR (
   Pid CHAR(10) NOT NULL,
   Ppassword VARCHAR(20) NOT NULL,
   Pname VARCHAR(5) NOT NULL,
   Primary key(Pid)
);

CREATE TABLE if not exists UNIVERSITY.STUDENT (
   Sid CHAR(10) NOT NULL,
   Spassword VARCHAR(20) NOT NULL,
   Sname VARCHAR(5) NOT NULL,
   Year INT NOT NULL,
   Email VARCHAR(30),
   Pno CHAR(11),
   Dept VARCHAR(15) NOT NULL,
   Primary key(Sid)
);

CREATE TABLE if not exists UNIVERSITY.COURSE (
   Cid CHAR(10) NOT NULL,
   CName VARCHAR(5) NOT NULL,
   Pid CHAR(10) NOT NULL,
   Primary key(Cid),
   FOREIGN KEY(Pid) REFERENCES PROFESSOR(Pid) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE if not exists UNIVERSITY.ENROLL (
   Sid CHAR(10) NOT NULL,
   Cid CHAR(10) NOT NULL,
   Primary key(Sid, Cid),
   FOREIGN KEY(Sid) REFERENCES STUDENT(Sid) ON UPDATE CASCADE ON DELETE CASCADE,
   FOREIGN KEY(Cid) REFERENCES COURSE(Cid) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE if not exists UNIVERSITY.MATERIALS (
   Cid CHAR(10) NOT NULL,
   Mno INT NOT NULL,
   Title VARCHAR(30) NOT NULL,
   Content VARCHAR(512) NOT NULL,
   Date DATE NOT NULL,
   Views INT,
   Primary key(Cid, Mno),
   FOREIGN KEY(Cid) REFERENCES COURSE(Cid) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE if not exists UNIVERSITY.ATTACHMENTS (
   Cid CHAR(10) NOT NULL,
   Mno INT NOT NULL,
   Ano INT NOT NULL,
   Aname VARCHAR(50) NOT NULL,
   Primary key(Cid, Mno, Ano),
   FOREIGN KEY(Cid, Mno) REFERENCES MATERIALS(Cid, Mno) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE if not exists UNIVERSITY.NOTE (
Sid CHAR(10) NOT NULL,
Nno INT NOT NULL,
Content VARCHAR(512),
Cid CHAR(10) NOT NULL,
Primary key(Sid, Nno),
FOREIGN KEY(Sid) REFERENCES STUDENT(Sid) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(Cid) REFERENCES COURSE(Cid) ON UPDATE CASCADE ON DELETE CASCADE
);